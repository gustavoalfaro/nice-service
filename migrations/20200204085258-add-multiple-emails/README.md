# Migration `20200204085258-add-multiple-emails`

This migration has been generated by Gustavo Alfaro at 2/4/2020, 8:52:58 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."User.email"

CREATE TABLE "public"."Email" (
    "email" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "user" text   ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."User" DROP COLUMN "email";

CREATE UNIQUE INDEX "Email.email" ON "public"."Email"("email")

ALTER TABLE "public"."Email" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200203212001-initial..20200204085258-add-multiple-emails
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator photon {
   provider = "prisma-client-js"
@@ -9,9 +9,9 @@
 model User {
   id         String  @default(cuid()) @id
   username   String  @unique
-  email      String  @unique
+  email      Email[]
   firstName  String
   lastName   String
   type       String
   telephones Telephone[]
@@ -20,5 +20,10 @@
 model Telephone {
   id          String  @default(cuid()) @id
   phone       Int  @unique
   description String
+}
+
+model Email {
+  id          String  @default(cuid()) @id
+  email       String @unique
 }
```


